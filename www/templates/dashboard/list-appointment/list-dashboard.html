<!--View Information-->
<!--View name : Dashboard-->
<!--Controller name : dashboardCtrl-->
<!--Controller path : www/templates/dashboard/js/controllers.js-->
<!--State name : app.dashboard-->
<!--URL : #app/dashboard-->

<ion-view title="Suas consultas">

	<!--dashboard section-->
	<ion-content id="dashboard-content">
        <div class="list card" ng-repeat="request in appointmentRequests | showOnlyIfStatusIs:'NEW'">
			<div class="item item-icon-left">
				<i class="icon fa fa-clock-o positive"></i>
				<h2 class="positive"><strong>{{ getMedicalSpecialization(request.speciality) }} Solicitado</strong><h2>
			</div>
			<div class="item item-body">
				<h3>Sua consulta será agendada em até 1 dia útil.</h3>
				<p><i class="icon fa fa-calendar"></i> Pedido feito em <strong>{{ formatDate(request.createdAt) }}</strong>.</p>
			</div>
			<div class="row text-center">
				<div class="col-50">
					<a class="item icon-left ion-close">
						&nbsp; Cancelar
					</a>
				</div>
				<div class="col-50">
					<a class="item icon-left ion-ios-information-outline" ng-click="moreDetails(request)">
						&nbsp; Detalhes
					</a>
				</div>
			</div>
        </div>

		<!-- TODO Criar componente -->
        <!-- <div class="list card" ng-repeat="appointment in scheduledAppointments"> -->
        <div class="list card" ng-repeat="appointment in appointments | showOnlyIfStatusIs:'SCHEDULED'">
			<div class="item item-icon-left">
					<i class="icon fa fa-question energized"></i>
					<h2 class="energized"><strong>Confirmação de {{ getMedicalSpecialization(appointment.doctor.speciality) }}</strong><h2>
			</div>
			<div class="item item-body">
				<h3>Já agendamos sua consulta! Agora só falta confirmar.</h3>
				<h3><strong><i class="icon fa fa-hospital-o fa-lg"></i> {{ appointment.clinic.name }}</strong></h3>
				<h3><strong><i class="icon fa fa-stethoscope fa-lg"></i> Dr(a) {{ appointment.doctor.name }}</strong></h3>
				<h3>Quando</h3>
				<p><i class="icon fa fa-calendar"></i> {{ formatDate(appointment.when) }}</p>
				<h3>Onde</h3>
				<p>
					<a href="maps:{{ appointment.clinic.name }} {{ appointment.clinic.address }}" />
					<i class="icon fa fa-map-marker"></i> {{ appointment.clinic.address }} </a>
				</p>
			</div>
			<div class="row text-center">
				<div class="col-50">
					<a class="item icon-left ion-close" ng-click="refuse(appointment)">
						&nbsp; Recusar
					</a>
				</div>
				<div class="col-50">
					<a class="item icon-left ion-checkmark" ng-click="accept(appointment)">
						&nbsp; Aceitar
					</a>
				</div>
			</div>
        </div>

		<!-- TODO Criar componente -->
		<div class="list card" ng-repeat="appointment in appointments | showOnlyIfStatusIs:'ACCEPTED'">
			<div class="item item-icon-left">
					<i class="icon fa fa-calendar-check-o balanced"></i>
					<h2 class="balanced"><strong>{{ getMedicalSpecialization(appointment.doctor.speciality) }} Agendado</strong><h2>
			</div>
			<div class="item item-body">
				<h3>Você tem uma consulta <strong>{{ relativeDateFormat(appointment.when) }}</h3>
				<h3><strong><i class="icon fa fa-hospital-o fa-lg"></i> {{ appointment.clinic.name }}</strong></h3>
				<h3><strong><i class="icon fa fa-stethoscope fa-lg"></i> Dr(a) {{ appointment.doctor.name }}</strong></h3>
				<h3>Quando</h3>
				<p><i class="icon fa fa-calendar"></i> {{ formatDate(appointment.when) }}</p>
				<h3>Onde</h3>
				<p>
					<a href="maps:{{ appointment.clinic.name }} {{ appointment.clinic.address }}" />
					<i class="icon fa fa-map-marker"></i> {{ appointment.clinic.address }} </a>
				</p>
			</div>
			<div class="row text-center">
				<div class="col-50">
					<a class="item icon-left ion-close" ng-click="cancel(appointment)">
						&nbsp; Desmarcar
					</a>
				</div>
				<div class="col-50" ng-if='canConfirm(appointment)'>
					<a class="item icon-left ion-checkmark" ng-click="confirm(appointment)">
						&nbsp; Confirmar
					</a>
				</div>
			</div>
        </div>
    </ion-content><!--end dashboard section-->
</ion-view>
